var asset_counter=new Array();function addNote(c,b){var a=new Ext.create("Ext.Component",{xtype:"box",autoEl:{tag:"a",href:note_link,children:[{tag:"img",id:"responsible-image",cls:"tooltip",src:"http://cdn1.iconfinder.com/data/icons/lullacons/info.png",}]},renderTo:"toolcontainer-"+c});new Ext.ToolTip({target:a.el.id,title:(lang=="de")?"Info":"Note",html:"<br>"+b,autoHide:true})}function addTooltip(a,c,b){var d=new Ext.create("Ext.Component",{xtype:"box",autoEl:{tag:"a",href:scheduler_link,children:[{tag:"img",id:"tooltip-image",cls:"tooltip",src:"http://cdn1.iconfinder.com/data/icons/crystalproject/16x16/mimetypes/schedule.png",}]},renderTo:"toolcontainer-"+a});new Ext.ToolTip({target:d.el.id,html:b,autoHide:true})}function addResponsible(d,b,c){var a=new Ext.create("Ext.Component",{xtype:"box",autoEl:{tag:"a",href:b,children:[{tag:"img",src:"http://cdn1.iconfinder.com/data/icons/humano2/16x16/emblems/emblem-people.png"}]},renderTo:"toolcontainer-"+d});new Ext.ToolTip({target:a.el.id,html:c,autoHide:true})}function addTitleTooltip(c,b,a){new Ext.ToolTip({target:"course_title-"+c,title:"Details:",html:b,autoHide:true})}function addCourse(k,n,l,e,i,g,b,d,j,a,m,c){var f=new Number(a);var a=f.toString();var h=Ext.create("Ext.panel.Panel",{xtype:"panel",cls:"course",bodyCls:"course_body",title:"<span class='course_title'>"+k+"</span><span class='course_creditpoints'>"+e+" CP</span>",width:course_width,height:65,margin:"2 1 0 1",bodyStyle:{"background-color":"#E5E5E5","border-top-style":"none"},listeners:{afterrender:function(o){o.header.addCls("course_panel_header");document.getElementById(o.el.id).firstChild.style.background="#"+d;if(g!=null){addTooltip(a,l,g)}if(j!=""){addNote(a,j)}if(b!=""){addResponsible(a,b,c)}addTitleTooltip(a,l,m)}},layout:{type:"vbox",align:"center"},items:[{xtype:"container",anchor:"100% 50%",html:"<div id='course_title-"+a+"' align='center' class='course-title-container'><a class='course-title' href='http://website.mni.fh-giessen.de/index.php/studium/informatik-bachelor/modulhandbuch-informatik-bsc/details/"+i+"'>"+((title_cut_length_activate==1)?(n.substring(0,title_cut_length)+"..."):n)+"</a></div>",flex:1,margins:"-8 0 0 0",},{xtype:"container",anchor:"70% 50%",html:"<div class='toolcontainer' id='toolcontainer-"+a+"'></div>",margins:"22 20 10 23",flex:1}]});return h}function addElectivePool(h,l,m,g,e,i,c,f,b,k,j){var d="";if(m==g){d=m}else{d=m+"-"+g}var a=Ext.create("Ext.panel.Panel",{xtype:"container",width:100,height:65,cls:"elective-pool",layout:"absolute",margin:"2 1 0 1",bodyStyle:{border:"none","background-color":"#"+j},listeners:{afterrender:function(n){}},items:[{xtype:"panel",title:"",x:20,y:10,height:65,width:90,shadow:"drop",shadowOffset:20,bodyStyle:{"background-color":"#E5E5E5"},},{xtype:"panel",title:"",x:8,y:8,height:55,width:90,bodyStyle:{"background-color":"#E5E5E5"},},{xtype:"panel",title:"<span class='elective_pool_title course_title' >"+h+"</span><span class='elective_pool_creditpoints'>"+d+" CP</span>",x:0,y:0,width:95,height:60,plain:true,listeners:{afterrender:function(n){n.header.addCls("elective_pool_panel_header");document.getElementById(n.el.id).firstChild.style.background="#"+c;if(f!=""){addNote(i,f)}addTitleTooltip(b,k,"")}},bodyStyle:{"background-color":"#E5E5E5"},items:[{xtype:"container",anchor:"70% 50%",html:"<div id='course_title-"+b+"' align='center' class='course-title-container'><a href='#' class='course-title pool"+i+"' >"+((title_cut_length_activate==1)?(l.substring(0,title_cut_length)+"..."):l)+"</a></div>",margins:"0 0 0 0",flex:1,listeners:{afterrender:function(o){var n=".pool"+i;Ext.select(n).on("click",function(p){e.show()})}},},{xtype:"container",anchor:"70% 110%",html:"<div class='toolcontainer' align='center' id='toolcontainer-"+i+"'></div>",margins:"-10 0 0 0",flex:1},]}]});return a}function addSemester(a){var a=Ext.create("Ext.panel.Panel",{xtype:"panel",title:'<font style="font-size: 12px;">'+a+"</font>",layout:"anchor",cls:"semester",margin:"3 8 0 8",autoScroll:true,collapsible:true,listeners:{afterrender:function(g){g.header.addCls("panel_curriculum_semester");var f=this.items.length;var e=null;var b=0;for(var d=0;d<f;d++){childPanel=this.items.get(d);e+=this.items.get(d).getWidth()+15;if(this.items.get(d).getHeight()>b){b=this.items.get(d).getHeight()+10}}if(e>g.width){this.setWidth(e)}if(b>g.height){this.setHeight(b)}},collapse:function(b){}}});return a}function addCurriculum(c,a){var b=Ext.create("Ext.panel.Panel",{width:c,height:a,layout:"anchor",id:"curriculum_container",cls:"curriculum",autoScroll:true,autoHeight:true,listeners:{afterrender:function(e){e.body.applyStyles("background-color: #EFEFEF");var d=e.items.items.length}}});return b}function addCompulsoryPool(c,e,a,b){var d=Ext.create("Ext.panel.Panel",{xtype:"panel",width:300,height:100,layout:"hbox",margin:"1 1 1 1",cls:"compulsory-pool",bodyStyle:{"background-color":"#"+b},listeners:{afterrender:function(j){var i=this.items.length;var h=null;var f=0;for(var g=0;g<i;g++){childPanel=this.items.get(g);h+=this.items.get(g).getWidth()+7;if(this.items.get(g).getHeight()>f){f=this.items.get(g).getHeight()+10}}this.setWidth(h);this.setHeight(f)}}});return d}function addElectivePoolWindow(e,b,c,a){var d=Ext.create("Ext.window.Window",{title:'<font class="window_title">'+e+'</font><span class="window_creditpoints" >'+b+" - "+c+" CP</span>",height:50,width:50,cls:"elective-pool-window",layout:"anchor",closeAction:"hide",listeners:{afterrender:function(l){l.header.addCls("elective_pool_window_header");document.getElementById(l.header.id).firstChild.style.background="#"+a;var j=l.getDockedItems();var i=this.items.length;var h=null;var f=0;for(var g=0;g<i;g++){childPanel=this.items.get(g);h+=this.items.get(g).getWidth();f+=this.items.get(g).getHeight()+12}if(h>l.width){this.setWidth(h)}if(f>l.height){this.setHeight(f)}}},modal:true,bodyStyle:{"background-color":"white"}});return d}function buildNestedStructure(e){var c=Ext.create("Ext.panel.Panel",{border:1,layout:"hbox",width:50,listeners:{afterrender:function(n){var m=this.items.length;var l=null;var i=0;for(var j=0;j<m;j++){childPanel=this.items.get(j);l+=this.items.get(j).getWidth()+5;i=this.items.get(j).getHeight()+5}if(l>n.width){this.setWidth(l)}this.setHeight(i)}}});var f=addElectivePoolWindow(e.abbreviation,e.min_creditpoints,e.max_creditpoints,e.color_hex);var h=e.childs;if(typeof(e.childs[0].length)!="undefined"){h=e.childs[0]}for(var d=0,b=h.length;d<b;++d){var e=null;if(h[d].asset_type_id==1){var a=addCourse(h[d].abbreviation,h[d].short_title,h[d].title_de,h[d].min_creditpoints,h[d].lsf_course_id,h[d].schedule,h[d].responsible,h[d].color_hex,h[d].note,h[d].semesters_majors_id,h[d].lsf_course_code,h[d].responsible_name);e=a}else{if(h[d].asset_type_id==2){var g=addElectivePool(h[d].abbreviation,h[d].short_title,h[d].min_creditpoints,h[d].max_creditpoints,buildNestedStructure(h[d]),h[d].id,h[d].color_hex,h[d].note);e=g}}if(c.items.length<1){c.add(e)}else{c=Ext.create("Ext.panel.Panel",{border:1,layout:"hbox",width:50,height:50,listeners:{afterrender:function(n){var m=this.items.length;var l=null;var i=0;for(var j=0;j<m;j++){childPanel=this.items.get(j);l+=this.items.get(j).getWidth()+5;i=this.items.get(j).getHeight()+5}if(l>n.width){this.setWidth(l)}if(i>n.height){this.setHeight(i)}}}});c.add(e)}f.add(c)}return f}function addContainer(){var a=Ext.create("Ext.panel.Panel",{layout:"hbox"});return a}function getTitleLabel(b){var a=null;if(b.short_title==""){a=b.title}else{a=b.short_title}return a}Ext.Loader.setConfig({enabled:true,paths:{Ext:"components/com_thm_lsf/views/curriculum/tmpl/ext-4.0"}});Ext.application({name:"AM",appFolder:"app",launch:function(){var b=addCurriculum(width,height);var a=new Array();Ext.Ajax.request({url:"index.php?option=com_thm_lsf&task=curriculum.getJSONCurriculum&tmpl=component&id="+major_id+"&Itemid="+itemid,method:"GET",success:function(c){var o=Ext.decode(c.responseText);var n=o[0].childs[0];for(var s=0,t=n.length;s<t;++s){var v=addSemester(n[s].name);var u=n[s].childs;var m=addContainer();for(var q=0,h=u.length;q<h;++q){if(Ext.Array.contains(a,u[q].title_de)){if(typeof(asset_counter[u[q].title_de])!="undefined"){asset_counter[u[q].title_de]++}else{asset_counter[u[q].title_de]=1}u[q].title_de+=(lang=="de")?" Teil "+asset_counter[u[q].title_de]:" Part 2"}a.push(u[q].title_de);var w=getTitleLabel(u[q]);if(u[q].asset_type_id==1){var d=addCourse(u[q].abbreviation,w,u[q].title_de,u[q].min_creditpoints,u[q].lsf_course_id,u[q].schedule,u[q].responsible,u[q].color_hex,u[q].note,u[q].semesters_majors_id,u[q].lsf_course_code,u[q].responsible_name);if(m.items.length<asset_line_break){m.add(d)}else{m=Ext.create("Ext.panel.Panel",{layout:"hbox",border:0});m.add(d)}v.add(m)}else{if(u[q].min_creditpoints==u[q].max_creditpoints){if(Ext.Array.contains(a,u[q].title_de)){u[q].short_title+=" Teil2"}a.push(u[q].title_de);var e=addCompulsoryPool(u[q].title_de,u[q].min_creditpoints,u[q].min_creditpoints,u[q].color_hex);var f=u[q].childs;for(var p=0,g=f.length;p<g;++p){var w=getTitleLabel(f[p]);var l=f[p].title_de+"<br><br>Pool:<br>"+u[q].title_de+" ("+u[q].min_creditpoints+"-"+u[q].max_creditpoints+" CP)<br><br>Info:<br>"+u[q].note;if(f[p].asset_type_id==1){var d=addCourse(f[p].abbreviation,w,l,f[p].min_creditpoints,f[p].lsf_course_id,f[p].schedule,f[p].responsible,f[p].color_hex,f[p].note,f[p].semesters_majors_id,f[p].lsf_course_code,f[p].responsible_name);e.add(d)}else{if(u[q].min_creditpoints==u[q].max_creditpoints){}else{}var r=addElectivePool(f[p].abbreviation,f[p].short_title,f[p].min_creditpoints,f[p].max_creditpoints,buildNestedStructure(f[p]),f[p].semesters_majors_id,f[p].color_hex,f[p].note,f[p].semesters_majors_id,l,u[q].color_hex);e.add(r)}}if(m.items.length<asset_line_break){m.add(e)}else{m=Ext.create("Ext.panel.Panel",{layout:"hbox",border:0});m.add(e)}v.add(m)}else{if(Ext.Array.contains(a,u[q].title_de)){u[q].short_title+=" Teil2"}a.push(u[q].title_de);var r=addElectivePool(u[q].abbreviation,u[q].short_title,u[q].min_creditpoints,u[q].max_creditpoints,buildNestedStructure(u[q]),u[q].semesters_majors_id,u[q].color_hex,u[q].note);if(m.items.length<asset_line_break){m.add(r)}else{m=Ext.create("Ext.panel.Panel",{layout:"hbox",border:0});m.add(r)}v.add(m)}}}b.add(v)}}});b.doLayout();b.render(Ext.Element.get("curriculum"))}});