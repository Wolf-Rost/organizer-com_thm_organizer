function Curriculum(h,p,k,s,o,m,q,e,b,n,a,j,c,r,f,d,i,g){var l=this;var q=q;var e=e;var b=b;var n=n;var a=a;var j=j;var c=c;var r=r;var f=f;var d=d;var i=i;var g=g;var s=s;Curriculum.prototype.hex2rgb=function(w){if(w[0]=="#"){w=w.substr(1)}if(w.length==3){var t=w;w="";t=/^([a-f0-9])([a-f0-9])([a-f0-9])$/i.exec(t).slice(1);for(var v=0;v<3;v++){w+=t[v]+t[v]}}var u=/^([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})$/i.exec(w).slice(1);return{red:parseInt(u[0],16),green:parseInt(u[1],16),blue:parseInt(u[2],16)}};Curriculum.prototype.contrastColor=function(v){var t=this.hex2rgb(v);var u=Math.sqrt(t.red*t.red*0.241+t.green*t.green*0.691+t.blue*t.blue*0.068);if(u<130){return"rgb(255, 255, 255)"}else{return"rgb(0, 0, 0)"}};Curriculum.prototype.addNote=function(y,w,t){var x=(s=="de")?"Info":"Info";var u=(s=="de")?"<br>Klicken f&uuml;r weitere Informationen":"Click for additional information";if(t==0&&g==""){var v=new Ext.create("Ext.Component",{xtype:"box",autoEl:{tag:"img",id:"responsible-image",cls:"tooltip",src:note_icon,},renderTo:"toolcontainer-"+y})}else{if((t!=0&&g=="")||(t!=0&&g!="")){var v=new Ext.create("Ext.Component",{xtype:"box",autoEl:{tag:"a",href:t,target:"_blank",children:[{tag:"img",id:"responsible-image",cls:"tooltip",src:note_icon,}]},renderTo:"toolcontainer-"+y})}else{var v=new Ext.create("Ext.Component",{xtype:"box",autoEl:{tag:"a",href:g,target:"_blank",children:[{tag:"img",id:"responsible-image",cls:"tooltip",src:note_icon,}]},renderTo:"toolcontainer-"+y})}}new Ext.ToolTip({target:v.el.id,title:x,html:"<div>"+w+((t!=0||g!="")?u:"")+"</div><br>",dismissDelay:0,autoHide:true,})};Curriculum.prototype.addEcollab=function(x,v){var w=(s=="de")?"Info":"Info";var t=(s=="de")?"<br>Klicken f&uuml;r weitere Informationen":"Click for additional information";var u=new Ext.create("Ext.Component",{xtype:"box",autoEl:{tag:"a",href:v,target:"_blank",children:[{tag:"img",id:"collab-image",cls:"tooltip",src:collab_icon,}]},renderTo:"toolcontainer-"+x});new Ext.ToolTip({target:u.el.id,title:w,html:"<br>"+v+"<br>"+t,dismissDelay:0,autoHide:true,})};Curriculum.prototype.addTooltip=function(u,w,v){var t=null;if(c!=""){t=(s=="de")?"<br>Klicken f&uuml;r weitere Informationen":"Click for additional information"}var x=new Ext.create("Ext.Component",{xtype:"box",autoEl:{tag:"a",target:"_blank",href:c,children:[{tag:"img",id:"tooltip-image",cls:"tooltip",src:scheduler_icon,}]},renderTo:"toolcontainer-"+u});new Ext.ToolTip({target:x.el.id,title:"Details:",html:v+t,dismissDelay:0,autoHide:true,})};Curriculum.prototype.addPlacehodlerIcon=function(t){var u=new Ext.create("Ext.Component",{xtype:"box",autoEl:{tag:"img",id:"tooltip-image",src:place_holder_icon},renderTo:"toolcontainer-"+t})};Curriculum.prototype.addResponsible=function(z,y,w,u){var x=(s=="de")?"Modulverantwortliche:":"Responsible:";var v=null;var t="";if(y){t=(s=="de")?"Klicken f&uuml;r weitere Informationen":"Click for additional information";v=new Ext.create("Ext.Component",{xtype:"box",autoEl:{tag:"a",href:y,children:[{tag:"img",src:responsible_icon}]},renderTo:"toolcontainer-"+z})}else{v=new Ext.create("Ext.Component",{xtype:"box",autoEl:{cls:"tooltip",tag:"img",src:responsible_icon},renderTo:"toolcontainer-"+z})}new Ext.ToolTip({target:v.el.id,title:x,html:"<hr style='width:130px;visibility: hidden'>"+w+"<div style='margin-top:4px;margin-bottom:4px;'align='center'>"+(u?u:"")+"</div><div>"+t+"</div><br>",dismissDelay:0,autoHide:true,})};Curriculum.prototype.addTitleTooltip=function(u,t){new Ext.ToolTip({target:"course_title-"+u,html:t,dismissDelay:0,autoHide:true,})};Curriculum.prototype.addContainer=function(u){var t=Ext.create("Ext.container.Container",{layout:"hbox",width:0,height:66,bodyStyle:{"background-color":u},defaultMargins:{top:0,right:0,bottom:0,left:0},listeners:{afterrender:function(y){var x=0;var v=0;for(var w=0;w<this.items.length;w++){x+=this.items.get(w).getWidth()+4;if(this.items.get(w).getHeight()>v){v=this.items.get(w).getHeight()+4}}if(x>y.width){this.setWidth(x)}if(v>y.height){this.setHeight(v)}}}});return t};Curriculum.prototype.addPoolContainer=function(u){var t=Ext.create("Ext.container.Container",{layout:"hbox",width:0,height:66,defaultMargins:{top:0,right:10,bottom:0,left:0},bodyStyle:{"background-color":"#"+u},listeners:{afterrender:function(y){var x=0;var v=0;for(var w=0;w<this.items.length;w++){x+=this.items.get(w).getWidth()+4;if(this.items.get(w).getHeight()>v){v=this.items.get(w).getHeight()+4}}if(x>y.width){this.setWidth(x)}if(v>y.height){this.setHeight(v)}}}});return t};Curriculum.prototype.getTitleLabel=function(t){var u=null;if(t.short_title==""){u=t.title}else{u=t.short_title}return u};Curriculum.prototype.addDummy=function(u,v,t){if(u.indexOf("#")==-1){u="#"+u}var w=Ext.create("Ext.panel.Panel",{xtype:"panel",cls:"dummy",bodyCls:"dummy_body",margin:t+" 0 0 "+v,width:e,height:65,border:false,bodyStyle:{"background-color":u,top:"-1px"},});return w};Curriculum.prototype.addCourse=function(w,t,E,D){if(E===undefined){E="2"}if(D===undefined){D="2"}var y=new Number(w.semesters_majors_id);var u=y.toString();var C=this.getTitleLabel(w);var v=this.contrastColor(w.color_hex);var A=this.contrastColor(b);var z="index.php?option=com_thm_organizer&view=details&lang="+s+"&id="+w.lsf_course_id+"&Itemid="+h;var x=((a==1)?(C.substring(0,j)+"..."):C);var B=Ext.create("Ext.panel.Panel",{xtype:"panel",cls:"course",bodyCls:"course_body",title:"<span style='color:"+v+";'class='course_title'>"+w.abbreviation.substr(0,10)+"</span><span style='color:"+v+";'class='course_creditpoints'>"+w.min_creditpoints+" CrP</span>",width:e,height:65,margin:D+" 0 0 "+E,bodyStyle:{"background-color":b},listeners:{afterrender:function(F){F.header.addCls("course_panel_header");document.getElementById(F.el.id).firstChild.style.background="#"+w.color_hex;if(w.schedule!=null){l.addTooltip(u,w.title,w.schedule)}else{l.addPlacehodlerIcon(u)}if(w.responsible!=""){l.addResponsible(u,w.responsible_link,w.responsible_name,w.responsible_picture)}else{l.addPlacehodlerIcon(u)}if(w.note!=""||w.menu_link!=0||g!=""){l.addNote(u,w.note,w.menu_link)}else{l.addPlacehodlerIcon(u)}if(w.ecollaboration_link!=""){l.addEcollab(u,w.ecollaboration_link)}else{l.addPlacehodlerIcon(u)}l.addTitleTooltip(u,t)}},layout:{type:"anchor",align:"center"},items:[{xtype:"container",anchor:"100% 70%",html:"<div id='course_title-"+u+"' align='center' class='course-title-container'><a target='_blank' style='color:"+A+";'class='course-title' href='"+z+"'>"+x+"</a></div>"},{xtype:"container",anchor:"100% 30%",html:"<div align='center' class='toolcontainer' id='toolcontainer-"+u+"'></div>",margin:"-3 0 0 0"}]});return B};Curriculum.prototype.addPoolIcon=function(t,v,u){var w=new Ext.create("Ext.Component",{xtype:"box",autoEl:{tag:"img",id:"test",cls:"comp_pool_icon",src:comp_pool_icon,},renderTo:"pool_icon_container-"+t});return w.id};Curriculum.prototype.addElectivePool=function(u,z,D,C,A){if(u.min_creditpoints==u.max_creditpoints){var v=u.min_creditpoints}else{var v=u.min_creditpoints+"-"+u.max_creditpoints}var x=this.getTitleLabel(u);var B=this.contrastColor(u.color_hex);var y=this.contrastColor(n);var w=((a==1)?(u.short_title.substring(0,j)+"..."):x);var t=Ext.create("Ext.panel.Panel",{xtype:"panel",cls:"elective_pool",title:"<span style='color:"+B+";'class='elective_pool_title course_title' >"+u.abbreviation+"</span><span style='color:"+B+";'class='elective_pool_creditpoints'>"+v+" CrP</span>",width:e,height:65,margin:A+" 0 0 "+C,listeners:{afterrender:function(G){G.header.addCls("course_panel_header");l.addTitleTooltip(u.semesters_majors_id,D);document.getElementById(G.el.id).firstChild.style.background="#"+u.color_hex;if(u.note!=""||u.menu_link!=0||g!=""){l.addNote(u.semesters_majors_id,u.note,u.menu_link)}var F=l.addPoolIcon(u.semesters_majors_id,D);var E="#"+F;Ext.select(E).on("click",function(H){z.show()})}},bodyStyle:{"background-color":n,},layout:{type:"anchor",align:"center"},items:[{xtype:"container",anchor:"100% 35%",html:"<div id='course_title-"+u.semesters_majors_id+"' align='center' class='course-title-container'><span style='color: "+y+";' class='course-title pool"+u.semesters_majors_id+"' >"+w+"</span></div>",listeners:{afterrender:function(F){var E=".pool"+u.semesters_majors_id;Ext.select(E).on("click",function(G){z.show()})}},},{xtype:"container",anchor:"100% 35%",border:true,html:"<div class='pool_icon_container' align='center' id='pool_icon_container-"+u.semesters_majors_id+"'></div>"},{xtype:"container",anchor:"100% 30%",html:"<div style='margin-left:35px;' class='toolcontainer' align='center' id='toolcontainer-"+u.semesters_majors_id+"'></div>"}]});return t};Curriculum.prototype.addSemester=function(v){var x=q;if(v.color){var t=this.contrastColor(v.color)}if(s=="de"){var u=v.short_title_de}else{var u=v.short_title_en}var w=Ext.create("Ext.panel.Panel",{xtype:"panel",title:'<span style="font-size: 12px; color: '+t+';">'+u+"</span>",layout:"anchor",cls:"semester",margin:"8 0 0 0",autoHeight:true,collapsible:true,border:false,listeners:{afterrender:function(y){y.header.addCls("panel_curriculum_semester");document.getElementById(y.el.id).firstChild.style.background="#"+v.color;document.getElementById(y.el.id).lastChild.style.background="#"+v.color;y.body.applyStyles("background-color:"+x)}}});return w};Curriculum.prototype.addCurriculum=function(v,t){var u=Ext.create("Ext.container.Container",{width:v,height:t,layout:"anchor",id:"curriculum_container_"+i,cls:"curriculum",autoScroll:true,autoHeight:true,border:false});return u};Curriculum.prototype.addCompulsoryPool=function(u,v,t){var w=Ext.create("Ext.container.Container",{xtype:"panel",layout:"anchor",border:false,margin:(t-1)+" 0 0 "+(v-1),cls:"compulsory-pool",style:{"background-color":"#"+u}});return w};Curriculum.prototype.addElectivePoolWindow=function(y,v,w,t){var u=this.contrastColor(t);var x=Ext.create("Ext.window.Window",{title:"<span class='window_title' style='color: "+u+";'>"+y+" (Min: "+v+" CrP, Max:"+w+" CrP)</span> ",cls:"elective_pool_window",autoScroll:"true",layout:"anchor",closeAction:"hide",modal:true,bodyStyle:{"background-color":"white"},listeners:{afterrender:function(z){z.header.addCls("elective_pool_window_header");document.getElementById(z.header.id).firstChild.style.background="#"+t}}});return x};Curriculum.prototype.buildElectiveContent=function(u){var B=u;var t=this.addContainer(u.hex_color);var A=this.getTitleLabel(u);var y=this.addElectivePoolWindow(A,u.min_creditpoints,u.max_creditpoints,u.color_hex);var z=u.childs;var v=false;if(typeof z==="undefined"){y.add(t.add(this.addDummy()));return y}if(u.childs.length==0){u=this.addDummy("255255255",2,2);t=this.addContainer(u.hex_color);t.add(u);y.add(t);return y}if(typeof u.childs[0].length==="undefined"){z=u.childs}else{z=u.childs[0]}for(var w=0,x=z.length;w<x;++w){var u=this.getAsset(z[w],B);if(w==0){u=this.getAsset(z[w],B,2,2)}else{if(v==true){u=this.getAsset(z[w],B,1,2)}else{u=this.getAsset(z[w],B,2,2)}}if(t.items.length<f){t.add(u)}else{u=this.getAsset(z[w],B,2,2);t=this.addContainer(u.hex_color);t.add(u)}if(z[w].asset_type_id==2&&z[w].pool_type==0){v=true}y.add(t)}return y};Curriculum.prototype.addCompPoolText=function(y){var z=this.getTitleLabel(y);var w=new Number(y.semesters_majors_id);var A=w.toString();var u=this.contrastColor(y.color_hex);if(y.min_creditpoints==y.max_creditpoints){if(s=="de"){var v=" insgesamt "+y.min_creditpoints+" CrP"}else{var v=" overall "+y.min_creditpoints+" CrP"}}else{if(s=="de"){var v=" insgesamt "+y.min_creditpoints+" CrP bis "+y.max_creditpoints+" CrP"}else{var v=" overall "+y.min_creditpoints+" CrP to "+y.max_creditpoints+" CrP"}}var x="<span style='color: "+u+";' class='course_title' id='course_title-"+y.semesters_majors_id+"'><b>"+z+":</b>"+v+"<span style='margin-left:3px' class='toolcontainer' align='center' id='toolcontainer-"+y.semesters_majors_id+"'></span>";+"</span>";var t=Ext.create("Ext.container.Container",{layout:"hbox",minHeight:17,margin:"0 0 3 4",cls:"comp_pool_text_container",html:x,listeners:{afterrender:function(C){var B=y.title;if(y.note){B+="<br><br>"+y.note}if(y.note!=""||y.menu_link!=0||g!=""){l.addNote(y.semesters_majors_id,B,y.menu_link)}}}});return t};Curriculum.prototype.addSemesterText=function(w){var u=this.contrastColor(q);var v="<span style='color: "+u+";' class='course_title'>"+w.note+"</span>";var t=Ext.create("Ext.container.Container",{layout:"hbox",cls:"semester_text_container",html:v});return t};Curriculum.prototype.buildCompulsoryContent=function(C,B,A){var u=this.addCompulsoryPool(C.color_hex,B,A);var t=this.addPoolContainer(C.color_hex);var w=false;if(C.childs){var z=null;if(typeof C.childs[0].length==="undefined"){z=C.childs}else{z=C.childs[0]}for(var x=0,y=z.length;x<y;x++){if(x==0){var v=this.getAsset(z[x],C,1,1)}else{if(w==true){var v=this.getAsset(z[x],C,1,1)}else{var v=this.getAsset(z[x],C,2,1)}}if(t.items.length<d){t.add(v)}else{t=this.addContainer(C.color_hex);t.add(this.getAsset(z[x],C,1,1))}if(v.asset_type_id==2&&v.pool_type==0){w=true}u.add(t)}}else{return""}u.add(this.addCompPoolText(C));return u};Curriculum.prototype.getAsset=function(x,w,v,t){var y=y=x.title+" ("+((x.lsf_course_code!="")?x.lsf_course_code:x.his_course_code)+")";if(x.asset_type_id==1){return this.addCourse(x,y,v,t)}else{if(x.asset_type_id==2){if(x.pool_type==0){return this.buildCompulsoryContent(x,v,t)}else{return this.addElectivePool(x,this.buildElectiveContent(x),x.title,v,t)}}else{if(x.asset_type_id==3){var u=null;if(typeof w.color_hex==="undefined"){u=q}else{u=w.color_hex}return this.addDummy(u,v,t)}}}}};